<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Noto+Serif+TC:wght@500&display=swap" rel="stylesheet">
    <title>設備借還 - 北市聯醫仁愛院區超音波追蹤器2.0</title>
    <style>
        :root {
            --color-primary: #334155;
            --color-primary-hover: #1e293b;
            --color-available: #307351;
            --color-borrowed: #A93F55;
            --color-text-primary: #334155;
            --color-text-secondary: #64748b;
            --color-border: #e2e8f0;
            --color-bg: #f8fafc;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --transition-base: 200ms ease;

            /* Spacing System */
            --spacing-xs: 4px;
            --spacing-sm: 8px;
            --spacing-md: 16px;
            --spacing-lg: 24px;
            --spacing-xl: 32px;
            --spacing-2xl: 48px;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans TC', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: var(--color-text-primary);
        }

        /* ============================================
           HEADER SECTION
           ============================================ */

        .header {
            text-align: center;
            margin-bottom: var(--spacing-2xl);
            animation: fadeInDown 0.6s ease;
        }

        .header-subtitle {
            color: var(--color-text-secondary);
            font-size: 14px;
            font-family: 'Noto Serif TC', serif;
            font-weight: 500;
            margin: 0 0 var(--spacing-sm) 0;
            letter-spacing: 0.5px;
        }

        .header-title {
            color: var(--color-text-primary);
            font-size: clamp(24px, 5vw, 36px);
            font-family: 'Noto Sans TC', sans-serif;
            font-weight: 900;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
        }

        .header-icon {
            width: 32px;
            height: 32px;
            flex-shrink: 0;
        }


        .form-container {
            background: white;
            padding: 32px;
            border-radius: 16px;
            box-shadow: var(--shadow-lg);
            width: 100%;
            max-width: 420px;
            animation: fadeInUp 0.4s ease;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .formheader {
            text-align: center;
            margin-bottom: 28px;
        }

        .formheader h1 {
            margin: 0 0 12px 0;
            font-size: 22px;
            font-weight: 700;
            color: var(--color-text-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .formheader-icon {
            width: 24px;
            height: 24px;
        }

        .device-name {
            font-size: 18px;
            color: var(--color-primary);
            font-weight: 700;
            padding: 12px 16px;
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            border-radius: 10px;
            border: 2px solid var(--color-border);
        }

        .type-badge {
            display: inline-block;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            margin-top: 15px;
        }

        .type-badge.borrow {
            background-color: #fce8e6;
            color: #A93F55;
        }

        .type-badge.return {
            background-color: #e6f4ea;
            color: #307351;
        }

        .form-group {
            margin-bottom: 24px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: var(--color-text-primary);
            font-weight: 600;
            font-size: 14px;
        }

        input[type="text"],
        select {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid var(--color-border);
            border-radius: 10px;
            font-size: 16px;
            font-family: inherit;
            transition: all var(--transition-base);
            -webkit-appearance: none;
            appearance: none;
            background-color: white;
        }

        input[type="text"]:focus,
        select:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px rgba(51, 65, 85, 0.1);
        }

        input[type="text"]:hover:not(:focus),
        select:hover:not(:focus) {
            border-color: #cbd5e1;
        }

        select {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23334155' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 14px center;
            padding-right: 40px;
            cursor: pointer;
        }

        .return-info {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
            border: 2px solid var(--color-border);
        }

        .return-info .info-row {
            display: flex;
            margin-bottom: 12px;
            padding: 4px 0;
        }

        .return-info .info-row:last-child {
            margin-bottom: 0;
        }

        .return-info .info-label {
            color: var(--color-text-secondary);
            width: 90px;
            flex-shrink: 0;
            font-size: 14px;
            font-weight: 600;
        }

        .return-info .info-value {
            color: var(--color-text-primary);
            font-weight: 700;
            font-size: 15px;
        }

        button[type="submit"] {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-size: 17px;
            font-weight: 700;
            cursor: pointer;
            transition: all var(--transition-base);
            box-shadow: var(--shadow-md);
            font-family: inherit;
        }

        button.borrow-btn {
            background: linear-gradient(135deg, var(--color-primary) 50%, var(--color-borrowed) 100%);
            color: white;
        }

        button.return-btn {
            background: linear-gradient(135deg, var(--color-primary) 50%, var(--color-available) 100%);
            color: white;
        }

        button.borrow-btn:hover,
        button.return-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        button.borrow-btn:active,
        button.return-btn:active {
            transform: translateY(0);
        }

        button[type="submit"]:disabled {
            background: #cbd5e1;
            cursor: not-allowed;
            transform: none;
            box-shadow: var(--shadow-sm);
        }

        .message {
            margin-top: 20px;
            padding: 14px 16px;
            border-radius: 10px;
            text-align: center;
            display: none;
            font-size: 15px;
            font-weight: 600;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.success {
            background-color: #dcfce7;
            color: #166534;
            border: 2px solid #bbf7d0;
            display: block;
        }

        .message.error {
            background-color: #fee2e2;
            color: #991b1b;
            border: 2px solid #fecaca;
            display: block;
        }

        .error-page {
            text-align: center;
            padding: 40px 20px;
        }

        .error-page h2 {
            color: #dc2626;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .error-page p {
            color: var(--color-text-secondary);
            line-height: 1.6;
        }

        .input-hint {
            font-size: 12px;
            color: var(--color-text-secondary);
            margin-top: 6px;
        }

        .dashboard-link {
            display: block;
            width: 100%;
            padding: 14px;
            margin-top: 16px;
            background-color: white;
            color: var(--color-primary);
            text-align: center;
            text-decoration: none;
            border-radius: 10px;
            border: 2px solid var(--color-border);
            font-size: 15px;
            font-weight: 600;
            transition: all var(--transition-base);
        }

        .dashboard-link:hover {
            background-color: #f8fafc;
            border-color: var(--color-primary);
        }

        /* 響應式設計 */
        @media (max-width: 480px) {
            .form-container {
                padding: 24px;
            }

            .header h1 {
                font-size: 20px;
            }

            .device-name {
                font-size: 16px;
            }
        }

        /* 無障礙設計 */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                transition-duration: 0.01ms !important;
            }
        }

        *:focus-visible {
            outline: 2px solid var(--color-primary);
            outline-offset: 2px;
        }

        .copyright {
            text-align: center;
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg);
            color: var(--color-text-secondary);
            font-size: 13px;
            animation: fadeIn 1s ease 0.6s backwards;
        }

        footer {
            text-align: center;
            padding: 20px;
            font-size: 12px;
            color: var(--color-text-secondary);
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
         <p class="header-subtitle">臺北市立聯合醫院仁愛院區</p>
            <h1 class="header-title">
                <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M8.9778 8.35429C18.7472 5.21452 29.2538 5.21526 39.0227 8.3564C41.5056 9.15478 42.6029 11.9037 41.6666 14.2306L35.3047 30.0405C35.2816 30.0977 35.2585 30.1559 35.235 30.2147C35.0075 30.7852 34.754 31.421 34.3671 31.908C33.8635 32.5419 33.1826 32.8943 32.2547 32.9942C31.7056 33.0534 31.2125 32.6562 31.1534 32.1071C31.0942 31.558 31.4914 31.0649 32.0405 31.0058C32.5173 30.9544 32.6778 30.8192 32.8012 30.664C32.9974 30.4169 33.1434 30.054 33.432 29.3369L39.8112 13.484C40.3543 12.1343 39.6886 10.6714 38.4105 10.2604C29.0396 7.24723 18.9611 7.24652 9.58975 10.2584C8.31157 10.6692 7.64567 12.132 8.18857 13.4817L14.5691 29.3444C14.8552 30.0556 15.0002 30.4163 15.1954 30.6626C15.3184 30.8177 15.4784 30.9528 15.9542 31.0045C16.5032 31.0641 16.9 31.5576 16.8403 32.1066C16.7807 32.6557 16.2872 33.0524 15.7382 32.9928C14.8107 32.892 14.1307 32.539 13.6281 31.905C13.2428 31.4189 12.9901 30.7846 12.7634 30.2156C12.7396 30.1559 12.7161 30.0969 12.6928 30.0389L6.33305 14.2281C5.39705 11.9011 6.49473 9.15232 8.9778 8.35429ZM18.6424 12.0657C20.3409 11.3621 22.1614 11 24 11C25.8385 11 27.659 11.3621 29.3575 12.0657C31.0561 12.7693 32.5994 13.8005 33.8995 15.1005C34.29 15.491 34.29 16.1242 33.8995 16.5147C33.5089 16.9052 32.8758 16.9052 32.4852 16.5147C31.3709 15.4004 30.0481 14.5165 28.5922 13.9134C27.1362 13.3104 25.5758 13 24 13C22.4241 13 20.8637 13.3104 19.4078 13.9134C17.9518 14.5165 16.629 15.4004 15.5147 16.5147C15.1241 16.9052 14.491 16.9052 14.1005 16.5147C13.7099 16.1242 13.7099 15.491 14.1005 15.1005C15.4005 13.8005 16.9438 12.7693 18.6424 12.0657ZM18.0097 16.9927C19.7437 15.6955 21.8519 14.9962 24.0174 15C26.1829 15.0038 28.2887 15.7104 30.0181 17.0136C30.4592 17.346 30.5473 17.973 30.2149 18.4141C29.8826 18.8552 29.2556 18.9433 28.8145 18.6109C27.4309 17.5683 25.7463 17.003 24.0139 17C22.2815 16.997 20.595 17.5564 19.2078 18.5941C18.7655 18.925 18.1388 18.8347 17.808 18.3924C17.4772 17.9502 17.5675 17.3235 18.0097 16.9927ZM18.9999 23.0639V24.8708C19.0485 24.8517 19.0981 24.8327 19.1488 24.8137C20.2534 24.3995 21.8721 24 24 24C26.1278 24 27.7465 24.3995 28.8511 24.8137C28.9018 24.8327 28.9514 24.8517 29 24.8708V23.0639C28.7943 22.9557 28.5106 22.822 28.1488 22.6863C27.2534 22.3505 25.8721 22 24 22C22.1278 22 20.7465 22.3505 19.8511 22.6863C19.4893 22.822 19.2056 22.9557 18.9999 23.0639ZM30 22.5L30.6 21.7C30.8518 21.8889 31 22.1852 31 22.5V26.7889C31 27.776 30.7078 28.7411 30.1602 29.5624L29.5038 30.547C29.1753 31.0398 29 31.6188 29 32.2111V35.9792C29 37.2038 28.5506 38.3858 27.737 39.301C26.9856 40.1464 26.0191 40.6723 25 40.8789V41C25 41.7693 25.8374 42.246 26.4989 41.8533L28.6167 40.5958C30.6801 39.3707 33.3449 40.0275 34.6026 42.0713L34.8516 42.4759C35.1411 42.9463 34.9944 43.5622 34.524 43.8517C34.0537 44.1411 33.4377 43.9945 33.1483 43.5241L32.8993 43.1195C32.214 42.0059 30.7621 41.648 29.6377 42.3155L27.52 43.573C25.5253 44.7573 23 43.3198 23 41V40.8789C21.9808 40.6723 21.0143 40.1464 20.2629 39.301C19.4493 38.3858 18.9999 37.2038 18.9999 35.9792V32.2111C18.9999 31.6188 18.8246 31.0398 18.4961 30.547L17.8397 29.5624C17.2921 28.7411 16.9999 27.776 16.9999 26.7889V22.5C16.9999 22.1852 17.1481 21.8889 17.3999 21.7L17.9999 22.5C17.3999 21.7 17.3996 21.7003 17.3999 21.7L17.4033 21.6975L17.4075 21.6944L17.418 21.6867C17.4261 21.6808 17.4361 21.6736 17.4482 21.6651C17.4724 21.6481 17.5047 21.626 17.545 21.5995C17.6258 21.5465 17.739 21.476 17.8847 21.394C18.1761 21.2301 18.5975 21.0204 19.1488 20.8137C20.2534 20.3995 21.8721 20 24 20C26.1278 20 27.7465 20.3995 28.8511 20.8137C29.4024 21.0204 29.8238 21.2301 30.1152 21.394C30.2609 21.476 30.3741 21.5465 30.4549 21.5995C30.4952 21.626 30.5275 21.6481 30.5517 21.6651C30.5638 21.6736 30.5738 21.6808 30.5819 21.6867L30.5924 21.6944L30.5966 21.6975L30.5984 21.6988L30.6 21.7C30.6003 21.7003 30.6 21.7 30 22.5ZM28.9879 27.0576C28.7832 26.9505 28.5035 26.8193 28.1488 26.6863C27.2534 26.3505 25.8721 26 24 26C22.1278 26 20.7465 26.3505 19.8511 26.6863C19.4964 26.8193 19.2167 26.9505 19.012 27.0576C19.0567 27.5551 19.2252 28.0351 19.5038 28.453L20.1602 29.4376C20.7078 30.2589 20.9999 31.224 20.9999 32.2111V35.9792C20.9999 36.7139 21.2696 37.4231 21.7577 37.9723C22.9511 39.3148 25.0488 39.3148 26.2422 37.9723C26.7303 37.4231 27 36.7139 27 35.9792V32.2111C27 31.224 27.2921 30.2589 27.8397 29.4376L28.4961 28.453C28.7747 28.0351 28.9432 27.5551 28.9879 27.0576ZM24 31C24.5522 31 25 31.4477 25 32V36C25 36.5523 24.5522 37 24 37C23.4477 37 23 36.5523 23 36V32C23 31.4477 23.4477 31 24 31Z" fill="currentColor"/>
                </svg>
                超音波追蹤器2.0
            </h1>
        </div>
    <div class="form-container" id="formContainer">

        <!-- 內容由 JavaScript 動態產生 -->
    </div>

    <script>
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyO8RH5s8lsvvyhjALXc29yO5j35FCQnWw5vnuf6FZr0Fx7YudsIwrzcXPeUP3tgp0tMw/exec';

        // 設備對應的歸還地點
        // 注意：設備名稱必須與 Google Sheet 中的「設備ID」欄位完全一致（包括空格和大小寫）
        const RETURN_LOCATIONS = {
            'CVC echo': '8東儲藏室',
            '新三頭超音波': '1118醫師辦公室',
            '舊二頭超音波': '1118醫師辦公室'
        };

        // 借出地點選項
        const BORROW_LOCATIONS = [
            '4西', '5西', '6東', '6西', '7東', '8東',
            '9西', '10西', '11西', '12西', '洗腎室', '詠愛病房'
        ];

        // 有效的設備 ID
        const VALID_DEVICES = Object.keys(RETURN_LOCATIONS);

        // 從 URL 取得參數
        const urlParams = new URLSearchParams(window.location.search);
        const deviceId = urlParams.get('device_id');
        const actionType = urlParams.get('type');

        // 驗證參數
        function validateParams() {
            if (!deviceId || !VALID_DEVICES.includes(deviceId)) {
                return { valid: false, error: '無效的設備 ID' };
            }
            if (!actionType || !['借出', '歸還'].includes(actionType)) {
                return { valid: false, error: '無效的操作類型' };
            }
            return { valid: true };
        }

        // 顯示錯誤頁面
        function showErrorPage(message) {
            document.getElementById('formContainer').innerHTML = `
                <div class="error-page">
                    <h2>參數錯誤</h2>
                    <p>${message}</p>
                    <p style="margin-top: 20px; font-size: 14px;">
                        請確認 QR Code 是否正確<br>
                        或聯繫管理員
                    </p>
                </div>
            `;
        }

        // 顯示借出表單
        function showBorrowForm() {
            const locationOptions = BORROW_LOCATIONS.map(loc =>
                `<option value="${loc}">${loc}</option>`
            ).join('');

            document.getElementById('formContainer').innerHTML = `
                <!-- <div class="formheader">
                     <h1>
                        <svg class="formheader-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7" />
                        </svg>
                        超音波追蹤器2.0
                    </h1> 
                    <div class="device-name">${deviceId}</div>
                    <span class="type-badge borrow">借出</span>
                </div> -->

                <div class="formheader">
                    <h1>${deviceId}</h1>
                </div>

                <form id="deviceForm">
                    <div class="form-group">
                        <label for="phoneNumber">公務機號碼</label>
                        <input type="text"
                               id="phoneNumber"
                               name="phoneNumber"
                               required
                               placeholder="請輸入4位數字"
                               pattern="[0-9]{4}"
                               maxlength="4"
                               inputmode="numeric"
                               autocomplete="off">
                        <div class="input-hint">請輸入 4 位數字（例如：0912）</div>
                    </div>
                    <div class="form-group">
                        <label for="location">借出地點</label>
                        <select id="location" name="location" required>
                            <option value="">請選擇地點</option>
                            ${locationOptions}
                        </select>
                    </div>
                    <button type="submit" class="borrow-btn" id="submitBtn">確認借出</button>
                </form>
                <div id="message" class="message"></div>
                <a href="index.html" class="dashboard-link">查看設備狀態總覽</a>
            `;

            // 綁定表單事件
            document.getElementById('deviceForm').addEventListener('submit', handleSubmit);

            // 限制只能輸入數字
            document.getElementById('phoneNumber').addEventListener('input', function(e) {
                this.value = this.value.replace(/[^0-9]/g, '').slice(0, 4);
            });
        }

        // 顯示歸還表單
        function showReturnForm() {
            const returnLocation = RETURN_LOCATIONS[deviceId];

            document.getElementById('formContainer').innerHTML = `
                <div class="formheader">
                <!-- <div class="formheader">
                     <h1>
                        <svg class="formheader-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7" />
                        </svg>
                        超音波追蹤器2.0
                    </h1> 
                    <div class="device-name">${deviceId}</div>
                    <span class="type-badge borrow">借出</span>
                </div> -->

                <div class="formheader">
                    <h1>${deviceId}</h1>
                </div>

                <div class="return-info">
                    <div class="info-row">
                        <span class="info-label">設備名稱</span>
                        <span class="info-value">${deviceId}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">歸還地點</span>
                        <span class="info-value">${returnLocation}</span>
                    </div>
                </div>
                <form id="deviceForm">
                    <button type="submit" class="return-btn" id="submitBtn">確認歸還</button>
                </form>
                <div id="message" class="message"></div>
                <a href="index.html" class="dashboard-link">查看設備狀態總覽</a>
            `;

            // 綁定表單事件
            document.getElementById('deviceForm').addEventListener('submit', handleSubmit);
        }

        // 處理表單送出
        async function handleSubmit(e) {
            e.preventDefault();

            const submitBtn = document.getElementById('submitBtn');
            const messageDiv = document.getElementById('message');

            // 準備資料
            let data = {
                deviceId: deviceId,
                borrowStatus: actionType
            };

            if (actionType === '借出') {
                const phoneNumber = document.getElementById('phoneNumber').value.trim();
                const location = document.getElementById('location').value;

                // 驗證公務機號碼
                if (!/^[0-9]{4}$/.test(phoneNumber)) {
                    messageDiv.textContent = '請輸入正確的 4 位數公務機號碼';
                    messageDiv.className = 'message error';
                    return;
                }

                data.username = phoneNumber;
                data.location = location;
            } else {
                // 歸還時不需要公務機號碼
                data.username = '-';
                data.location = RETURN_LOCATIONS[deviceId];
            }

            // 停用按鈕
            submitBtn.disabled = true;
            submitBtn.textContent = '送出中...';
            messageDiv.className = 'message';

            try {
                await fetch(SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });

                if (actionType === '借出') {
                    messageDiv.textContent = `${deviceId} 已借出至 ${data.location}`;
                } else {
                    messageDiv.textContent = `${deviceId} 已歸還至 ${data.location}`;
                }
                messageDiv.className = 'message success';

                // 重設表單
                if (actionType === '借出') {
                    document.getElementById('deviceForm').reset();
                }

                submitBtn.disabled = false;
                submitBtn.textContent = actionType === '借出' ? '確認借出' : '確認歸還';

            } catch (error) {
                messageDiv.textContent = '送出失敗，請稍後再試';
                messageDiv.className = 'message error';
                console.error('Error:', error);
                submitBtn.disabled = false;
                submitBtn.textContent = actionType === '借出' ? '確認借出' : '確認歸還';
            }
        }

        // 初始化頁面
        function init() {
            const validation = validateParams();

            if (!validation.valid) {
                showErrorPage(validation.error);
                return;
            }

            if (actionType === '借出') {
                showBorrowForm();
            } else {
                showReturnForm();
            }
        }

        // 執行初始化
        init();
    </script>


    <footer>
        © 2026 Yang Hao Wei. All Rights Reserved.
    </footer>
</body>
</html>
